# This is not ideal and requires NFS be set up on the host nodes via SSH
# TODO: Replace this with proper NFS drivers for a storage class.

apiVersion: v1
kind: PersistentVolume
metadata:
  name: dask-nfs-pv
spec:
  capacity:
    storage: 1000Gi
  accessModes:
    - ReadWriteMany
  persistentVolumeReclaimPolicy: Retain
  storageClassName: ""
  nfs:
    server: nas.lan
    path: /volume1/homelab
  mountOptions:
    - hard
    - nfsvers=4.1
    - rsize=1048576
    - wsize=1048576
    - timeo=600
    - retrans=2

# Uncomment the following section to create a test pod that uses the NFS PVC  
# ---
# apiVersion: v1
# kind: Pod
# metadata:
#   name: nfs-test-pod
#   namespace: default
# spec:
#   containers:
#   - name: nfs-container
#     image: busybox:latest
#     command: ["/bin/sh"]
#     args: ["-c", "while true; do echo $(date) >> /mnt/nfs/test.log; sleep 60; done"]
#     resources:
#       requests:
#         memory: "64Mi"
#         cpu: "50m"
#       limits:
#         memory: "128Mi"
#         cpu: "100m"
#     volumeMounts:
#     - name: nfs-storage
#       mountPath: /mnt/nfs
#   volumes:
#   - name: nfs-storage
#     persistentVolumeClaim:
#       claimName: nfs-synology-pvc
#   restartPolicy: Always